// See https://aka.ms/new-console-template for more information
using Microsoft.EntityFrameworkCore;
using Microsoft.Extensions.Configuration;
using Microsoft.Extensions.DependencyInjection;
using Microsoft.Extensions.Hosting;
using Solidus.SuicaTools;
using Solidus.SuicaTools.Data;
using System.Globalization;

static IConfigurationRoot BuildConfig(IConfigurationBuilder builder)
{
    return builder.SetBasePath(Directory.GetCurrentDirectory())
           .AddJsonFile("appsettings.json", false, true)
           .Build();
}

static IHost Startup()
{
    var builder = new ConfigurationBuilder();
    var config = BuildConfig(builder);

    var host = Host.CreateDefaultBuilder().ConfigureServices((context, services) =>
    {
        services.AddDbContext<TransitContext>(options => options.UseSqlServer(config.GetConnectionString("TrainStations")));
    }).Build();

    return host;
}

var host = Startup();
var ctx = host.Services.GetService<TransitContext>();

var trainRide_jre = new byte[] { 0x16, 0x01, 0x00, 0x02, 0x28, 0x50, 0x25, 0x0C, 0x03, 0x0D, 0x70, 0x01, 0x00, 0x00, 0xA2, 0x00 };
var trainRide_tokyometro = new byte[] { 0x16, 0x01, 0x00, 0x02, 0x28, 0x4D, 0xE3, 0x32, 0xE3, 0x30, 0xE5, 0x06, 0x00, 0x00, 0x91, 0x00 };
var trainRide_osakaSubway = new byte[] { 0x16, 0x01, 0x00, 0x02, 0x28, 0x4B, 0x81, 0x24, 0x81, 0x1C, 0x02, 0x01, 0x00, 0x00, 0x8C, 0xA0 };
var charge = new byte[] { 0x15, 0x02, 0x00, 0x00, 0x28, 0x4F, 0xF3, 0x19, 0x00, 0x00, 0x8B, 0x07, 0x00, 0x00, 0x98, 0x00 };
var purchase = new byte[] { 0xC7, 0x46, 0x00, 0x00, 0x28, 0x50, 0x5B, 0xEF, 0x07, 0x7B, 0xF8, 0x01, 0x00, 0x00, 0xA0, 0x00 };

var tram_sample = new byte[] { 0x05, 0x0F, 0x00, 0x0F, 0x0D, 0x9D, 0x05, 0xE1, 0xBC, 0x06, 0xF7, 0x01, 0x00, 0x00, 0x2F, 0xF0 };
